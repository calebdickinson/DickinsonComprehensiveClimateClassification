<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Embed → JSON converter</title>

<style>
body {
  font-family: system-ui;
  max-width: 900px;
  margin: 40px auto;
}

textarea {
  width: 100%;
  height: 160px;
  font-family: monospace;
  margin-bottom: 12px;
}

button {
  padding: 10px 18px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>

<body>

<h2>Paste embed HTML → get JSON-safe media</h2>

<b>Input (paste YouTube/Wikimedia embed):</b>
<textarea id="input"></textarea>

<button onclick="convert()">Convert</button>

<br><br>

<b>Output (ready for climatemedia.json):</b>
<textarea id="output"></textarea>

<script>
function convert() {
  let html = document.getElementById('input').value.trim();

  // -----------------------------
  // REMOVE width ONLY from <img> tags (keep <img ...> intact)
  // -----------------------------
  html = html.replace(
    /<img\b[^>]*>/gi,
    tag => tag.replace(/\swidth\s*=\s*(['"])[^'"]*\1/i, '')
  );

  // -----------------------------
  // ONLY change width/height inside <iframe ...>
  // -----------------------------
  html = html.replace(
    /<iframe\b[^>]*>/gi,
    tag => {
      // If width/height exist, overwrite them; if missing, add them.
      if (/width\s*=/.test(tag)) {
        tag = tag.replace(/width\s*=\s*(['"])[^'"]*\1/i, "width='1280'");
      } else {
        tag = tag.replace(/^<iframe\b/i, "<iframe width='1280'");
      }

      if (/height\s*=/.test(tag)) {
        tag = tag.replace(/height\s*=\s*(['"])[^'"]*\1/i, "height='720'");
      } else {
        tag = tag.replace(/^<iframe\b/i, "<iframe height='720'");
      }

      return tag;
    }
  );

  // convert quotes for JSON
  html = html.replace(/"/g, "'");

  document.getElementById('output').value = `"${html}"`;
}
</script>

</body>
</html>
